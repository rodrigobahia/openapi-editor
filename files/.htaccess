# ====================================
# Proteção Pasta Files - OpenAPI Editor
# ====================================

# Desabilitar listagem de diretórios
Options -Indexes

# Permitir apenas arquivos JSON e YAML
<FilesMatch "\.(?!(json|yaml|yml)$)[^.]*$">
    Deny from all
</FilesMatch>

# Bloquear execução de scripts
<FilesMatch "\.(php|js|html|htm|py|pl|cgi|sh|bat)$">
    Deny from all
</FilesMatch>

# Proteção adicional contra uploads maliciosos
<Files "*.php*">
    Deny from all
</Files>
<Files "*.phtml">
    Deny from all
</Files>
<Files "*.asp*">
    Deny from all
</Files>
<Files "*.jsp">
    Deny from all
</Files>

# Headers de segurança para arquivos permitidos
<FilesMatch "\.(json|yaml|yml)$">
    Header set Content-Type "application/json; charset=utf-8"
    Header set X-Content-Type-Options "nosniff"
    Header set Cache-Control "private, no-cache"
</FilesMatch>